---
# Fetch cluster credentials for proxy setup

- name: Ensure deployment-specific directory exists
  file:
    path: "./deployments/{{ deployment_id }}"
    state: directory
    mode: '0755'
  delegate_to: localhost

- name: Get kubeconfig
  fetch:
    src: "{{ kubeconfig_path }}"
    dest: "./deployments/{{ deployment_id }}/kubeconfig"
    flat: true

- name: Get kubeadmin-password
  fetch:
    src: "{{ kubeadmin_password_path }}"
    dest: "./deployments/{{ deployment_id }}/kubeadmin-password"
    flat: true 